<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><!-- InstanceBegin template="/Templates/sdkDoc.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../style_sdk.css" rel="stylesheet" type="text/css"/>
<!-- InstanceBeginEditable name="doctitle" -->
<title>ListenUp Server Scripts</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" -->
   
   <meta name="Author" content="Phil Burk">
   <meta name="KeyWords" content="record, voice, Applet, upload, server, scripts, PHP, ASP, JSP">
   <style type="text/css">
<!--
.style1 {color: #FF0066}
.style2 {
	font-family: "Courier New", Courier, monospace;
	font-weight: bold;
}
-->
   </style>
<!-- InstanceEndEditable -->
</head>
<body>
<center>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr valign="middle">
      <td width="200" bgcolor="#DCE2E7"><center>
          <font color="#FF9933" size="+2"><strong><em><a href="http://www.javasonics.com/" target="_top"> <font face="Verdana, Arial, Helvetica, sans-serif">JavaSonics</font></a></em> </strong></font>
        </center></td>
      <td width="60" bgcolor="#DCE2E7"><center>
          <h1>SDK</h1>
        </center></td>
      <td bgcolor="#DCE2E7"><center>
          <h1><!-- InstanceBeginEditable name="mainHeading" -->Documentation<!-- InstanceEndEditable --></h1>
        </center></td>
    </tr>
  </table>
</center>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
  <tr>
    <td valign="top" width="100" bgcolor="#D7E5F2"><br>
      <p><a class="sidenavbar" href="http://www.javasonics.com/" target="_top">Web&nbsp;Home</a></p>
      <p><a class="sidenavbar" href="../index.html" target="_top">SDK&nbsp;Home</a></p>
      <p><a class="sidenavbar" href="index.html" target="_top">Docs</a></p>
      <p><a class="sidenavbar" href="../php_test/index.html" target="_top">Test&nbsp;PHP</a></p>
      <p><a class="sidenavbar" href="../asp_test/index.html" target="_top">Test&nbsp;ASP</a></p>
      <p><a class="sidenavbar" href="../asp_net_test/index.html" target="_top">Test&nbsp;ASP.NET</a></p>
      <p><a class="sidenavbar" href="../examples/index.html" target="_top">Examples</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/demos/" target="_top">Demos</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/downloads/" target="_top">Download</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/sales/" target="_top">Purchase</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/support/" target="_top">Support</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/forum/" target="_top">Forum</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/login/" target="_top">Login</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/contacts.php" target="_top">Contact&nbsp;Us</a></p>
      <p><a class="sidenavbar" href="http://www.mobileer.com/" target="_blank">Company</a></p>
      <br>
    </td>
    <td valign="top"><div class="primary"> <!-- InstanceBeginEditable name="primaryContent" -->

<h2>
Writing Server Scripts to Receive Uploaded File</h2>
<p>ListenUp sends the recorded message to the server  as a file using an HTTP POST. The URL for the POST is that specified using the &quot;<a href="recorder_parameters.html">uploadURL</a>&quot; Applet parameter. You can write your own scripts to receive the uploaded file and integrate it with your own web based application. </p>
<p>Note that any scripting language may be used on the server including
PHP, JSP, ASP, Perl, etc. We have provided sample scripts for some languages in the SDK. These can be found in the test folders. Look, for example, in the &quot;<strong>php_test</strong>&quot; folder for &quot;<strong>handle_upload_simple.php</strong>&quot;.</p>
<h3>Upload Server Script Requirements (<span class="style1">IMPORTANT</span>) </h3>
<p>The upload server scripts that you write must meet certain requirements. How you do that will depend on the scripting language that you use. More details will be given in the  sections for specific languages.</p>
<ol>
    <li>Set HTTP header flags, or modify URL each time, so that page output will not be cached.</li>
    <li>Set header flags so that the page will be transmitted as plain text that is easily parsed by ListenUp.</li>
    <li>Receive and process variables from POST command.</li>
    <li>Validate the uploaded information to make sure the file is not too large or has an illegal name. You decide what is legal. </li>
    <li>Receive uploaded file and, if it is acceptable, move it to the folder where you store recordings.</li>
    <li><strong>Return a status line that starts with &quot;SUCCESS&quot;, WARNING&quot; or &quot;ERROR&quot;. </strong></li>
</ol>
<h3>Format of Uploaded Data </h3>
The Recorder Applet uploads its data using an HTTP POST in "multipart/form-data"
MIME format. This is the same format that HTML FORMs use. In fact, to the
server, ListenUp looks just like a submission from a FORM that
includes an uploaded file. This allows one to use  standard scripting
techniques on the server to receive the file. Rather than duplicate existing
documentation, I have included references to some available resources.
<p>To help you write your own server scripts, we have provided an HTML
page that simulates the ListenUp Applet. Please see the file "<a href="upload_form.html">upload_form.html</a>",
which contains an HTML FORM that uploads a file.
<h3>Uploaded Audio File </h3>
<p><b>Note: the MIME field name for the uploaded file is "userfile".</b> The uploaded file comes with a name but that is just a suggestion from the client. Your script is free to name the file anything you want. Click here for <a href="naming_files.html">suggestions for naming files on the server</a>.</p>
<p>The content type for Speex files is &quot;audio/x-ogg&quot;.</p>
<p>The content type for WAV files is &quot;audio/wav&quot;.</p>
<h3>Additional Information Uploaded with the Audio File</h3>
<p>The following variables are uploaded along with the recording. </p>
<blockquote>
  <p>&quot;duration&quot; = play time of the recording in seconds</p>
    </blockquote>
<p>You can also upload additional information as name/value pairs using <a href="text_fields.html">hidden text fields</a>. These could include user names, email addresses, etc. </p>
<h3>Returning a Result from Your Script to ListenUp </h3>
<p>The server script can send messages that will be displayed to the user.
    Any line beginning with the word "SUCCESS" or "ERROR" will be displayed
    in a label on the Applet. Any other output from the script will be echoed
    to the Java console by ListenUp for debugging. This return value is required in order for the JavaScript methods setUploadCompletionScript(script) or setUploadFailureScript(script) to be triggered.
<h3>Integration with a Database</h3>
<p>Your upload script can interact with a database. You may want to use a database to keep track of uploaded messages. In that case, we recommend placing the recorded message file in a regular folder, and just putting the filename in the database.</p>
<h3>Sending JavaScript Commands back to the Client</h3>
<p>You can send a JavaScript command from the server to the Applet running on the client. Just output &quot;CALLJS&quot; at the beginning of a line followed by the JavaScript code. You will also need to set  <span class="style2">mayscript=&quot;true&quot; </span>in the Applet tag. For example, to pop up an alert message on the client from a PHP server script:</p>
<blockquote>
  <pre>echo &quot;CALLJS alert('Server says Hello using CALLJS');\n&quot;;</pre>
</blockquote>
<h3>Continue with  Your Server Language</h3>
<blockquote>
    <h3>[<a href="script_php.html">PHP</a>] [<a href="script_jsp.html">JSP</a>] [<a href="script_asp.html">ASP</a>] [<a href="script_asp_net.html">ASP.NET</a>]</h3>
    </blockquote>
<p>If you are using another scripting language, then look in the documentation for that language of that language for keywords &quot;upload file&quot; and &quot;POST&quot; and &quot;HTML FORM&quot;.</p>
<p>[<a href="index.html">Top</a>] [<a href="recorder_basic.html">Previous</a>]  [<a href="naming_files.html">Next</a>] </p>
<!-- InstanceEndEditable --> </div></td>
  </tr>
</table>
<br>
<div align="left"> &copy; 2001-2006 <a href="http://www.mobileer.com/">Mobileer, Inc.</a> &nbsp;&nbsp;This page is from the ListenUp&nbsp;SDK. You can download the SDK from <a href="http://www.javasonics.com/downloads/">here</a>.</div>
</body>
<!-- InstanceEnd --></html>
