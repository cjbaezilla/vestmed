<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html><!-- InstanceBegin template="/Templates/sdkDoc.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link href="../style_sdk.css" rel="stylesheet" type="text/css"/>
<!-- InstanceBeginEditable name="doctitle" -->
<title>ListenUp Server Scripts</title>
<!-- InstanceEndEditable --><!-- InstanceBeginEditable name="head" -->
   
   <meta name="Author" content="Phil Burk">
   <meta name="KeyWords" content="record, voice, Applet, upload, server, scripts, PHP, ASP, JSP">
   <style type="text/css">
<!--
.style1 {color: #FF0066}
.style2 {
	font-family: "Courier New", Courier, monospace;
	font-weight: bold;
}
-->
   </style>
<!-- InstanceEndEditable -->
</head>
<body>
<center>
  <table width="100%" border="0" cellspacing="0" cellpadding="0">
    <tr valign="middle">
      <td width="200" bgcolor="#DCE2E7"><center>
          <font color="#FF9933" size="+2"><strong><em><a href="http://www.javasonics.com/" target="_top"> <font face="Verdana, Arial, Helvetica, sans-serif">JavaSonics</font></a></em> </strong></font>
        </center></td>
      <td width="60" bgcolor="#DCE2E7"><center>
          <h1>SDK</h1>
        </center></td>
      <td bgcolor="#DCE2E7"><center>
          <h1><!-- InstanceBeginEditable name="mainHeading" -->Documentation<!-- InstanceEndEditable --></h1>
        </center></td>
    </tr>
  </table>
</center>
<table width="100%" border="0" cellpadding="0" cellspacing="0" >
  <tr>
    <td valign="top" width="100" bgcolor="#D7E5F2"><br>
      <p><a class="sidenavbar" href="http://www.javasonics.com/" target="_top">Web&nbsp;Home</a></p>
      <p><a class="sidenavbar" href="../index.html" target="_top">SDK&nbsp;Home</a></p>
      <p><a class="sidenavbar" href="index.html" target="_top">Docs</a></p>
      <p><a class="sidenavbar" href="../php_test/index.html" target="_top">Test&nbsp;PHP</a></p>
      <p><a class="sidenavbar" href="../asp_test/index.html" target="_top">Test&nbsp;ASP</a></p>
      <p><a class="sidenavbar" href="../asp_net_test/index.html" target="_top">Test&nbsp;ASP.NET</a></p>
      <p><a class="sidenavbar" href="../examples/index.html" target="_top">Examples</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/demos/" target="_top">Demos</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/downloads/" target="_top">Download</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/sales/" target="_top">Purchase</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/support/" target="_top">Support</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/forum/" target="_top">Forum</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/login/" target="_top">Login</a></p>
      <p><a class="sidenavbar" href="http://www.javasonics.com/contacts.php" target="_top">Contact&nbsp;Us</a></p>
      <p><a class="sidenavbar" href="http://www.mobileer.com/" target="_blank">Company</a></p>
      <br>
    </td>
    <td valign="top"><div class="primary"> <!-- InstanceBeginEditable name="primaryContent" -->

<h2> Naming Files on the Server</h2>
<p>People often ask us how to name the audio files on the server. The file name is ultimately decided by the script that you write on your server. Your script  writes the file to disk. You have complete flexibility in naming those files.</p>
<h3>Suggesting File Names from the Client</h3>
<p>The client computer can send suggested names along with the uploaded file. There are two ways to specify this name.</p>
<p>1) Suggest a name using the&nbsp; "<a href="recorder_parameters.html">uploadFileName</a>" Applet parameter.</p>
<p>2) Use   JavaScript to upload the message and pass a file name. Details <a href="http://www.javasonics.com/listenup/docs/script_methods.html">here</a>.</p>
<pre>  document.ListenUpRecorder.sendRecordedMessage( uploadFileName )</pre>
<h3>Generating File Names on the Server</h3>
<p>When you receive a name from the client computer you should strip it down to prevent a hacker from uploading commands or pathnames to your server. This example shows how to do this in PHP. In all these examples we are writing to a folder called &quot;uploads&quot; but you can use any folder to store them. Note that you may need to change the permission of the folder so that PHP can write to it.</p>
<pre>  $raw_name = $_FILES['userfile']['name'];
  // Strip path to prevent uploads outside target directory.
  $actual_file_name = &quot;uploads/&quot; . basename($raw_name);</pre>
<p>You may want to put the time in seconds that the file was uploaded into the name. Note that if two people   upload a file in the same second then they will get the same file name.   So you may want to also include the user name. In this example we use a &quot;.wav&quot; suffix for normal WAV files. If you uploaded <a href="compression.html">Speex</a> files then use the &quot;.spx&quot; suffix.</p>
<pre>&nbsp;&nbsp;$actual_file_name = "uploads/msg_" . $user_name . "_" . time() . ".wav";</pre>
 <p>Or you can use a cryptic but unique name based on MD5.</p>
<pre>&nbsp;&nbsp;$actual_file_name = "uploads/msg_" . md5(<a href="http://www.php.net/uniqid" target="_blank">uniqid</a>(rand(),TRUE)) . ".wav";</pre>

<p>The most reliable way to get a unique name is to use  auto-incremented SQL database record IDs as part of the name. That is beyond the scope of this document.</p>
<p>Once you have a name you can move the audio recording from temporary storage to its final place.</p>
<pre>&nbsp;move_uploaded_file($_FILES['userfile']['tmp_name'], $actual_file_name ); </p>

   <p>[<a href="index.html">Top</a>] [<a href="server_scripts.html">Previous</a>]  [<a href="custom_parameters.html">Next</a>] </p>
<!-- InstanceEndEditable --> </div></td>
  </tr>
</table>
<br>
<div align="left"> &copy; 2001-2006 <a href="http://www.mobileer.com/">Mobileer, Inc.</a> &nbsp;&nbsp;This page is from the ListenUp&nbsp;SDK. You can download the SDK from <a href="http://www.javasonics.com/downloads/">here</a>.</div>
</body>
<!-- InstanceEnd --></html>
